{"version":3,"sources":["modules/project.js"],"names":[],"mappings":"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","file":"modules/project.js","sourcesContent":["var spawn = require('child_process').spawn;\nvar Q = require('q');\nvar jetpack = require('fs-jetpack');\nvar fs = require('fs');\nvar open = require(\"open\");\nvar fsExtra = require('node-fs-extra');\nconst EventEmitter = require('events');\nconst util = require('util');\n\nimport { utils } from './utils';\n\n\n/**\n * Creates a project instance-- allowing access and control of the current project open in the application.\n * @constructor\n * @param {string} path - The path to the cascade project.\n * @param {function} cb - Callback to run after project has initialized.\n * @param {string} name - Providing a name forces the application to create a new project at the specfied path instead of opening an existing project.\n */\nexport var Project = function (path, cb, name) {\n\n\tvar self = this;\n\tvar app = global.app;\n\n\tself.path = path;\n\n\tself.trigger = function(eventName, eventData, messageHandler) {\n\t\tself.emit(eventName, eventData);\n\t\tapp.message.send(eventName, eventData, messageHandler);\n\t}\n\n\tself.get = function (type, callback) {\n\t\tvar settingsFile = self.path + '/' + app.cascade.get('settingsFileName');\n\t\tvar settings = jetpack.read(settingsFile, 'json');\n\t\tvar event = {\n\t\t\tmessage: \"The 'get' function was called.\",\n\t\t\tdata : {key: type}\n\t\t}\n\t\tif (type === 'settings') {\n\t\t\tif (callback) {\n\t\t\t\tcallback(settings);\n\t\t\t}\n\t\t\treturn settings\n\n\t\t} else if (type === undefined) {\n\t\t\tif (callback) {\n\t\t\t\tcallback(self);\n\t\t\t}\n\t\t\tevent.data.key = 'self';\n\t\t\treturn self\n\t\t} else {\n\t\t\tif (callback) {\n\t\t\t\tcallback(settings[type]);\n\t\t\t}\n\t\t\treturn settings[type]\n\t\t}\n\t\tself.trigger('get', event);\n\t}\n\n\tself.set = function (key, value, callback) {\n\t\tvar settingsFile = self.path + '/' + app.cascade.get('settingsFileName');\n\t\tvar settings = jetpack.read(settingsFile, 'json');\n\t\tvar event = {\n\t\t\tmessage: \"The 'set' function was called\",\n\t\t\tdata : {key: key,value:value}\n\t\t}\n\t\tsettings[key] = value;\n\t\tjetpack.write(settingsFile, settings);\n\t\tif (callback) {\n\t\t\tcallback(settings[key]);\n\t\t}\n\t\tself.trigger('set', event);\n\t\treturn settings[key];\n\t}\n\n\tself.preview = function (target) {\n\t\tvar event = {\n\t\t\tmessage: \"Opening preview.\",\n\t\t\tdata : {\n\t\t\t\turl : \"http://localhost:\" + app.get('serverPort') + \"/\",\n\t\t\t\ttarget : target\n\t\t\t}\n\t\t}\n\t\tif (target === undefined) {\n\t\t\topen(\"http://localhost:\" + app.get('serverPort') + \"/\");\n\t\t\tevent.data.target = \"default\";\n\t\t} else {\n\t\t\topen(\"http://localhost:\" + app.get('serverPort') + \"/\", target);\n\t\t}\n\t\tself.trigger('preview', event);\n\t}\n\n\tself.viewIn = function (target) {\n\t\tvar event = {\n\t\t\tmessage: \"Viewing project in external application.\",\n\t\t\tdata : {\n\t\t\t\ttarget : target\n\t\t\t}\n\t\t}\n\t\tif (target === undefined) {\n\t\t\topen(app.project.get('path'), 'finder');\n\t\t\tevent.data.target = 'finder';\n\t\t} else {\n\t\t\topen(app.project.get('path'), target);\n\t\t}\n\t\tself.trigger('viewIn', event);\n\t}\n\n\tself.rename = function (name) {\n\t\tapp.trigger('loading:start');\n\t\tvar oldPath = app.cascade.get('settings').currentProjectDir;\n\t\tvar oldName = app.cascade.get('settings').currentProjectDir.split('/').pop();\n\t\tvar newPath = app.cascade.get('settings').currentProjectDir.split('/');\n\t\tnewPath.pop();\n\t\tnewPath.push(name);\n\t\tvar updatedPath = newPath.join('/');\n\t\tvar event = {};\n\n\t\tfs.access(updatedPath, fs.F_OK, function(err) {\n\t\t    if (!err) {\n\t\t    \tevent.message = \"Rename Failed\";\n\t\t    \tevent.error = \"A project or folder at that location with the same name already exists.\";\n\t\t        self.trigger('rename', event, 6);\n\t\t        app.trigger('loading:end');\n\t\t    } else {\n\t\t        fs.rename(oldPath, updatedPath, function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tevent.message = \"Rename Failed\";\n\t\t    \t\t\tevent.error = err;\n\t\t        \t\tself.trigger('rename', event, 6);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tapp.open(updatedPath);\n\t\t\t\t\t\tutils.setProjectIcon(updatedPath);\n\t\t\t\t\t\tevent.message = \"Successfully renamed project to '\" + name + \"'.\";\n\t\t        \t\tself.trigger('rename', event, 7);\n\t\t\t\t\t}\n\t\t\t\t\tapp.trigger('loading:end');\n\t\t\t\t});\n\t\t    }\n\t\t});\n\t}\n\n\tself.duplicate = function (newPath) {\n\t\tapp.trigger('loading:start');\n\t\tvar event = {};\n\t\tfs.access(newPath, fs.F_OK, function(err) {\n\t\t    if (!err) {\n\t\t        event.message = \"Project Duplication Failed\";\n\t\t        event.error = \"A project or folder at that location already exists.\";\n\t\t        self.trigger('rename', event, 6);\n\t\t        app.trigger('loading:end');\n\t\t    } else {\n\t\t        fsExtra.copy(self.path, newPath, function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tevent.message = \"Project Duplication Failed\";\n\t\t\t\t\t\tevent.error = err;\n\t\t\t\t\t\tself.trigger('rename', event, 6);\n\t\t\t\t    } else {\n\t\t\t\t    \tevent.message = \"Project successfully duplicated to: '\" + newPath + \"'.\";\n\t\t\t\t    \tself.trigger('rename', event, 7);\n\t\t\t\t    \tapp.open(newPath);\n\t\t\t\t    \tutils.setProjectIcon(newPath);\n\t\t\t\t  \t}\n\t\t\t\t  \tapp.trigger('loading:end');\n\t\t\t\t});\n\t\t    }\n\t\t});\n\t}\n\n\tself.publish = function (callback) {\n\t\tapp.trigger('loading:start');\n\t\tapp.cascade._run('publish', function(success) {\n\t\t\tif (success === true) {\n\t\t\t\tif (callback) {callback(success)}\n\t\t\t\tvar name = app.project.get('path').split('/').pop();\n\t\t\t\tvar file = app.project.get('path') + '/' + name + '.scc';\n\t\t\t\tself.trigger('publish', {\n\t\t\t\t\tmessage: \"Project published successfully\",\n\t\t\t\t\tdata: {file: file}\n\t\t\t\t}, 7);\n\t\t\t\t//utils.setProjectIcon(file, true);\n\t\t\t\topen(app.project.get('path'), 'finder');\n\t\t\t} else if (success === false) {\n\t\t\t\tif (callback) {callback(success)}\n\t\t\t\tself.trigger('publish', {\n\t\t\t\t\tmessage: \"Failed to publish project\",\n\t\t\t\t\terror: \"Unknown error.\",\n\t\t\t\t\tdata: {file: file}\n\t\t\t\t}, 6);\n\t\t\t}\n\t\t\tapp.trigger('loading:end');\n\t\t});\n\t}\n\n\tself._init = function (callback) {\n\t\tif (name) {\n\t\t\tapp.cascade.create(path, name, function (success) {\n\t\t\t\tif (success === false) {\n\t\t\t\t\tvar event = {\n\t\t\t\t\t\tmessage: \"Failed to create project at '\" + path + \"/\" + name + \"'.\" ,\n\t\t\t\t\t\terror: \"Unknown error\",\n\t\t\t\t\t\tdata: {path: path + '/' + name}\n\t\t\t\t\t}\n\t\t\t\t\t//utils.handleMessage(event.message, 0);\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(false);\n\t\t\t\t\t}\n\t\t\t\t\tself.trigger('init', event, 2);\n\t\t\t\t\treturn false\n\t\t\t\t} else {\n\t\t\t\t\tself.path = path + '/' + name;\n\t\t\t\t\tvar event = {\n\t\t\t\t\t\tmessage: \"The project at '\" + self.path + \"' was created.\",\n\t\t\t\t\t\tdata: {path: self.path}\n\t\t\t\t\t};\n\t\t\t\t\tself.trigger('created', event, 2);\n\t\t\t\t\t//utils.handleMessage(event.message, 0);\n\t\t\t\t\tutils.setProjectIcon(self.path);\n\t\t\t\t\tapp.cascade.start(self.path, function(status) {\n\t\t\t\t\t\tif (status === 'started') {\n\t\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\t\tcallback(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tself.trigger('init', {\n\t\t\t\t\t\t\t\tmessage: \"The project at '\" + self.path + \"' initialized successfully.\",\n\t\t\t\t\t\t\t\tdata: {path: self.path}\n\t\t\t\t\t\t\t}, 2);\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\t//utils.handleMessage(\"Initializing existing project at '\" + self.path + \"'.\", 0);\n\t\t\tapp.cascade.start(self.path, function(status) {\n\t\t\t\tif (status === 'started') {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(true);\n\t\t\t\t\t}\n\t\t\t\t\tutils.setProjectIcon(self.path);\n\t\t\t\t\tself.trigger('init', {\n\t\t\t\t\t\tmessage: \"The project at '\" + self.path + \"' initialized successfully.\",\n\t\t\t\t\t\tdata: {path: self.path}\n\t\t\t\t\t}, 2);\n\t\t\t\t\treturn true\n\t\t\t\t} else if (status === 'failed') {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(false);\n\t\t\t\t\t}\n\t\t\t\t\tself.trigger('init', {\n\t\t\t\t\t\tmessage: \"The project at '\" + self.path + \"' failed to initialize.\",\n\t\t\t\t\t\terror: \"Unknown error.\",\n\t\t\t\t\t\tdata: {path: self.path}\n\t\t\t\t\t}, 2);\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tself._init(cb);\n}\n\nutil.inherits(Project, EventEmitter);"],"sourceRoot":"/source/"}