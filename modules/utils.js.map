{"version":3,"sources":["modules/utils.js"],"names":[],"mappings":"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","file":"modules/utils.js","sourcesContent":["var jetpack = require('fs-jetpack');\nvar fs = require('fs');\nvar gui = require('nw.gui');\n\nexport var utils = {\n\tdownloadFile : function (fileUrl, callback) {\n\t\tvar app = global.app;\n\t\tvar fs = require('fs');\n\t\tvar fileName = fileUrl.split('/').pop();\n\t\tvar path = gui.App.dataPath + '/Downloads';\n\t\tvar file = path + '/' + fileName;\n\t\tvar download = app.request({url: fileUrl, encoding: null}, function(err, resp, body) {\n\t\t  \tif (err) {\n\t\t  \t\tapp.emit(\"download:end\");\n\t\t  \t\tcallback(false, err);\n\t\t  \t} else {\n\t\t  \t\tfs.access(path, fs.F_OK, function(err) {\n\t\t\t\t    if (err) {\n\t\t\t\t        console.log(\"Downloads directory doesn't exist. Creating it now.\");\n\t\t\t\t        fs.mkdirSync(path);\n\t\t\t\t    }\n\t\t\t\t    fs.writeFile(file, body, function(err) {\n\t\t\t  \t\t\tif (!err) {\n\t\t\t  \t\t\t\tapp.emit(\"download:end\", path + '/' + fileName, err);\n\t\t\t  \t\t\t\tcallback(path, fileName);\n\t\t\t  \t\t\t} else {\n\t\t\t  \t\t\t\tapp.emit(\"download:end\");\n\t\t\t  \t\t\t\tcallback(false, err);\n\t\t\t  \t\t\t}\n\t\t\t\t  \t});\n\t\t\t\t});\n\t\t  \t}\n\t\t});\n\t\tdownload.on('response', function(res) {\n\t\t\tvar size = res.headers['content-length'];\n\t\t\tvar currentSize = 0;\n\t\t\tvar percent;\n\t\t\tapp.emit(\"download:start\");\n\t\t\tdownload.on('data', function(data) {\n\t\t\t\tcurrentSize = currentSize + data.length;\n\t\t\t\tpercent = currentSize / size;\n\t\t\t\tapp.emit(\"download:progress\", percent);\n\t\t\t});\n\t\t});\n\t},\n\tcheckGithub : function(user, repo, callback) {\n\t\tvar app = global.app;\n\t\tvar githubRequest = app.request({url: 'https://api.github.com/repos/' + user + '/' + repo + '/releases/latest', headers: {'User-Agent':'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'}, encoding: null}, function(err, resp, body) {\n\t\t\tif (err) {\n\t\t\t\tcallback(false, err);\n\t\t\t} else {\n\t\t\t\tvar data = JSON.parse(body);\n\t\t\t    var archive = 'http://github.com/' + user + '/' + repo + '/archive/' + data.tag_name + '.zip';\n\t\t\t   \tvar remoteVersion = data.tag_name.replace('v', '').split('.');\n\t\t\t   \t// Need to replace the below with a way that won't get cached\n\t\t\t   \tvar currentVersion = require('./package.json').version.split('.');\n\t\t\t   \tvar newVersion = false;\n\t\t\t   \tif (remoteVersion[0] > currentVersion[0]) {\n\t\t\t   \t\tnewVersion = true;\n\t\t\t   \t} else if (remoteVersion[1] > currentVersion[1]) {\n\t\t\t   \t\tnewVersion = true;\n\t\t\t   \t} else if (remoteVersion[2] > currentVersion[2]) {\n\t\t\t   \t\tnewVersion = true;\n\t\t\t   \t}\n\t\t\t   \tif (newVersion === true) {\n\t\t\t   \t\tcallback(archive)\n\t\t\t\t} else {\n\t\t\t\t\tcallback(false);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tcopyNewAppFiles : function(from, to, callback) {\n\t\tvar child_process = require(\"child_process\");\n\t\tvar spawn = require('child_process').spawn;\n\t\tvar copyProcess = spawn('cp', ['-a', from + '/.', to + '/'], {detached: true, stdio : 'inherit'});\n\n\t\tcopyProcess.on('exit', function(code) {\n\t\t\tif (code === 0) {\n\t\t\t\tcallback()\n\t\t\t} else {\n\t\t\t\tcallback('error');\n\t\t\t}\n\t\t});\n\t},\n\tnwPath : function() {\n\t\tvar nwPath = global.app.path.split('/');\n\t\tnwPath.pop();\n\t\tnwPath = nwPath.join('/') + '/node_modules/nw/nwjs/nwjs.app/Contents/MacOS/nwjs'\n\t  \treturn nwPath;\n\t},\n\tsetProjectIcon : function(path, file) {\n\t\tvar spawn = require('child_process').spawn;\n\t\tvar app = global.app;\n\t\tvar scriptPath = app.path + \"/node_modules/fileicon/bin/fileicon\";\n\t\tvar folder = path;\n\t\tvar icon = app.path + app.get('settings').folderIcon;\n\t\tif (file) {\n\t\t\ticon = app.path + app.get('settings').fileIcon;\n\t\t}\n\t\tvar script = scriptPath + \" set \" + folder + \" \" + icon;\n\t\tvar args = ['set', folder, icon];\n\t\tvar runScript = spawn(scriptPath, args);\n\t}\n}\n"],"sourceRoot":"/source/"}